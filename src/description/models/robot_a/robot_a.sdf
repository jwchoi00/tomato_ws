<?xml version='1.0'?>
<sdf version='1.6'>
  <model name="robot1">
    <pose>0.0 0.0 0.0 0.0 0.0 0.0</pose>

    <link name='base_link'/>

    <joint name = 'body_joint' type='fixed'>
        <parent>base_link</parent>
        <child>robot_body</child>
        <pose> 0.0 0.0 0.36 0.0 0.0 0.0</pose>
    </joint>

    <link name="robot_body">
      <visual name="body_visual">
        <geometry>
          <mesh>
            <uri>model://robot_a/meshes/robot_a_body.dae</uri>
            <scale>0.001 0.001 0.001</scale>
          </mesh> 
        </geometry>
      </visual>
      <collision name="body_visual">
        <geometry>
          <mesh>
            <uri>model://robot_a/meshes/robot_a_body.dae</uri>
            <scale>0.001 0.001 0.001</scale>
          </mesh> 
        </geometry>
      </collision>
    </link>

    <joint name = 'r_wheel_joint' type='continuous'>
        <parent>robot_body</parent>
        <child>r_wheel</child>
        <pose> 0.35 0.23 -0.23 -1.57 0 0</pose>
        <axis> 
            <xyz>0 0 1</xyz>
        </axis>
    </joint>

    <link name="r_wheel">
      <visual name="r_wheel_visual">
        <geometry>
          <mesh>
            <uri>model://robot_a/meshes/robot_a_r_whell.dae</uri>
            <scale>0.001 0.001 0.001</scale>
          </mesh> 
        </geometry>
      </visual>
      <collision name="r_wheel_visual">
        <geometry>
          <mesh>
            <uri>model://robot_a/meshes/robot_a_r_whell.dae</uri>
            <scale>0.001 0.001 0.001</scale>
          </mesh> 
        </geometry>
      </collision>
    </link>

    <joint name = 'l_wheel_joint' type='continuous'>
        <parent>base_link</parent>
        <child>l_wheel</child>
        <pose> 0.35 0.23 -0.23 -1.57 0.0 0.0</pose>
        <axis>
            <xyz>0 0 1</xyz>
        </axis>
    </joint>

    <link name="l_wheel">
      <visual name="l_wheel_visual">
        <geometry>
          <mesh>
            <uri>model://robot_a/meshes/robot_a_l_wheel.dae</uri>
            <scale>0.001 0.001 0.001</scale>
          </mesh> 
        </geometry>
      </visual>
      <collision name="l_wheel_visual">
        <geometry>
          <mesh>
            <uri>model://robot_a/meshes/robot_a_l_wheel.dae</uri>
            <scale>0.001 0.001 0.001</scale>
          </mesh> 
        </geometry>
      </collision>
    </link>

    <plugin name="robot_a_diff_drive" filename="libgazebo_ros_diff_drive.so">

      <ros>
        <!-- <namespace>/robot0</namespace> -->
        <remapping>/tf:=tf</remapping>
      </ros>

      <update_rate>30</update_rate>
      <left_joint>l_wheel_joint</left_joint>
      <right_joint>r_wheel_joint</right_joint>

      <wheel_separation>0.287</wheel_separation>
      <wheel_diameter>0.066</wheel_diameter>

      <max_wheel_torque>20</max_wheel_torque>
      <max_wheel_acceleration>1.0</max_wheel_acceleration>

      <command_topic>cmd_vel</command_topic>

      <publish_odom>true</publish_odom>
      <publish_odom_tf>true</publish_odom_tf>
      <publish_wheel_tf>false</publish_wheel_tf>

      <odometry_topic>odom</odometry_topic>
      <odometry_frame>odom</odometry_frame>
      <robot_base_frame>base_footprint</robot_base_frame>

    </plugin>

    <plugin name="robot_a_joint_state" filename="libgazebo_ros_joint_state_publisher.so">
      <ros>
        <!-- <namespace>/tb3</namespace> -->
        <remapping>~/out:=joint_states</remapping>
      </ros>
      <update_rate>30</update_rate>
      <joint_name>l_wheel_joint</joint_name>
      <joint_name>r_wheel_joint</joint_name>
    </plugin>

  </model>
</sdf>